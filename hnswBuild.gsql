USE GRAPH Hnsw

CREATE QUERY hnsw_build() 
FOR GRAPH Hnsw SYNTAX V2 {

    /* Start to insert vertex sequentially after loading */

    INT M = 16;
    INT efConstruction = 200;
    FLOAT mL = 1 / log(M);
    SetAccum<Vertex<RootNode>> @@baseset;
    SumAccum<INT> @@count;

    a = SELECT v FROM RootNode:v 
        WHERE v.base == TRUE
        ACCUM @@baseset += v;

    FOREACH item IN @@baseset DO
        hnsw_insert(item, M, efConstruction, mL);
    END;
}

INSTALL QUERY hnsw_build